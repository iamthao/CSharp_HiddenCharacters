“
QD:\GithubSvn\GitHub\TestCommitGithub\AddWebsiteToIIS\InstallDatabase\InstallDb.cs
	namespace

 	
InstallDatabase


 
{ 
public 

class 
	InstallDb 
{ 
public 
static 
void 

RunSqlFile %
(% &
string& ,
pathFileAdmin- :
,: ;
string< B
pathFileUserC O
)O P
{ 	
var 
file 
= 
new 
FileInfo #
(# $
pathFileAdmin$ 1
)1 2
;2 3
var 
scriptAdmin 
= 
file "
." #
OpenText# +
(+ ,
), -
.- .
	ReadToEnd. 7
(7 8
)8 9
;9 :
var 
a 
= 
ExcuteMysql 
(  
scriptAdmin  +
)+ ,
;, -
var 
fileUser 
= 
new 
FileInfo '
(' (
pathFileUser( 4
)4 5
;5 6
var 

scriptUser 
= 
fileUser %
.% &
OpenText& .
(. /
)/ 0
.0 1
	ReadToEnd1 :
(: ;
); <
;< =
var 
b 
= 
ExcuteMysql 
(  

scriptUser  *
)* +
;+ ,
} 	
private 
static 
int 
ExcuteMysql &
(& '
string' -
sql. 1
)1 2
{ 	
var 
_connectionStr 
=  
$str! b
;b c
MySqlConnection 
sqlConnection )
=* +
null, 0
;0 1
try 
{ 
sqlConnection   
=   
new    #
MySqlConnection  $ 3
(  3 4
_connectionStr  4 B
)  B C
;  C D
sqlConnection!! 
.!! 
Open!! "
(!!" #
)!!# $
;!!$ %
int"" 
result"" 
;"" 
using## 
(## 
var## 

sqlComment## %
=##& '
new##( +
MySqlCommand##, 8
(##8 9
sql##9 <
,##< =
sqlConnection##> K
)##K L
)##L M
{$$ 
result%% 
=%% 

sqlComment%% '
.%%' (
ExecuteNonQuery%%( 7
(%%7 8
)%%8 9
;%%9 :
}&& 
return'' 
result'' 
;'' 
}(( 
catch)) 
()) 
	Exception)) 
ex)) 
)))  
{** 
return,, 
$num,, 
;,, 
}-- 
finally.. 
{// 
if00 
(00 
sqlConnection00 !
!=00" $
null00% )
)00) *
{11 
sqlConnection22 !
.22! "
Close22" '
(22' (
)22( )
;22) *
sqlConnection33 !
.33! "
Dispose33" )
(33) *
)33* +
;33+ ,
}44 
}55 
}66 	
}77 
}88 Š
_D:\GithubSvn\GitHub\TestCommitGithub\AddWebsiteToIIS\InstallDatabase\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str *
)* +
]+ ,
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str ,
), -
]- .
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *